# 13.0 Introduction

Scroll to begin

# **13.0.1 Why should I take this module?**

Welcome to ICMP!

Imagine that you have an intricate model train set. Your tracks and trains are all connected and powered up and ready to go. You throw the switch. The train goes halfway around the track and stops. You know right away that the problem is most likely located where the train has stopped, so you look there first. It is not as easy to visualize this with a network. Fortunately, there are tools to help you locate problem areas in your network, AND they work with both IPv4 and IPv6 networks! You will be happy to know that this module has a couple Packet Tracer activities to help you practice using these tools, so let’s get testing!

# **13.0.2 What will I learn in this module?**

**Module Title:** ICMP

**Module Objective:** Use various tools to test network connectivity.

|  |  |
| --- | --- |
|  |  |
|  |  |

# 13.1 ICMP Messages

Scroll to begin

# **13.1.1 ICMPv4 and ICMPv6 Messages**

In this topic, you will learn about the different types of Internet Control Message Protocols (ICMPs), and the tools that are used to send them.

Although IP is only a best-effort protocol, the TCP/IP suite does provide for error messages and informational messages when communicating with another IP device. These messages are sent using the services of ICMP. The purpose of these messages is to provide feedback about issues related to the processing of IP packets under certain conditions, not to make IP reliable. ICMP messages are not required and are often not allowed within a network for security reasons.

ICMP is available for both IPv4 and IPv6. ICMPv4 is the messaging protocol for IPv4. ICMPv6 provides these same services for IPv6 but includes additional functionality. In this course, the term ICMP will be used when referring to both ICMPv4 and ICMPv6.

The types of ICMP messages, and the reasons why they are sent, are extensive. The ICMP messages common to both ICMPv4 and ICMPv6 and discussed in this module include:

- Host reachability
- Destination or Service Unreachable
- Time exceeded

# **13.1.2 Host Reachability**

An ICMP Echo Message can be used to test the reachability of a host on an IP network. The local host sends an ICMP Echo Request to a host. If the host is available, the destination host responds with an Echo Reply. In the figure, click the Play button to see an animation of the ICMP Echo Request/Echo Reply. This use of the ICMP Echo messages is the basis of the **ping** utility.

animation of host 1 sending a ping ICMP echo request to host 2 and the ICMP echo reply from host 2 back to host 1

Yes, I am here.

**ping 192.168.30.1**

# play_circle_filled

# **13.1.3 Destination or Service Unreachable**

When a host or gateway receives a packet that it cannot deliver, it can use an ICMP Destination Unreachable message to notify the source that the destination or service is unreachable. The message will include a code that indicates why the packet could not be delivered.

Some of the Destination Unreachable codes for ICMPv4 are as follows:

- 0 - Net unreachable
- 1 - Host unreachable
- 2 - Protocol unreachable
- 3 - Port unreachable

Some of the Destination Unreachable codes for ICMPv6 are as follows:

- 0 - No route to destination
- 1 - Communication with the destination is administratively prohibited (e.g., firewall)
- 2 - Beyond scope of the source address
- 3 - Address unreachable
- 4 - Port unreachable

**Note:** ICMPv6 has similar but slightly different codes for Destination Unreachable messages.

# **13.1.4 Time Exceeded**

An ICMPv4 Time Exceeded message is used by a router to indicate that a packet cannot be forwarded because the Time to Live (TTL) field of the packet was decremented to 0. If a router receives a packet and decrements the TTL field in the IPv4 packet to zero, it discards the packet and sends a Time Exceeded message to the source host.

ICMPv6 also sends a Time Exceeded message if the router cannot forward an IPv6 packet because the packet has expired. Instead of the IPv4 TTL field, ICMPv6 uses the IPv6 Hop Limit field to determine if the packet has expired.

**Note:** Time Exceeded messages are used by the **traceroute** tool.

# **13.1.5 ICMPv6 Messages**

The informational and error messages found in ICMPv6 are very similar to the control and error messages implemented by ICMPv4. However, ICMPv6 has new features and improved functionality not found in ICMPv4. ICMPv6 messages are encapsulated in IPv6.

ICMPv6 includes four new protocols as part of the Neighbor Discovery Protocol (ND or NDP).

Messaging between an IPv6 router and an IPv6 device, including dynamic address allocation are as follows:

- Router Solicitation (RS) message
- Router Advertisement (RA) message

Messaging between IPv6 devices, including duplicate address detection and address resolution are as follows:

- Neighbor Solicitation (NS) message
- Neighbor Advertisement (NA) message

**Note:** ICMPv6 ND also includes the redirect message, which has a similar function to the redirect message used in ICMPv4.

Click each for an illustration and explanation of ICMPv6 messages.

RA MessageRS MessageNS MessageNA Message

RA messages are sent by IPv6-enabled routers every 200 seconds to provide addressing information to IPv6-enabled hosts. The RA message can include addressing information for the host such as the prefix, prefix length, DNS address, and domain name. A host using Stateless Address Autoconfiguration (SLAAC) will set its default gateway to the link-local address of the router that sent the RA.

R1 sends an RA router advertisement message to FF02::1 the all-nodes multicast address which will reach PC1.

2001:db8:acad:1::1/64PC12001:db8:acad:1::1/64fe80::1R1

RA Message

*R1 sends an RA message, “Hi all IPv6-enabled devices. I’m R1 and you can use SLAAC to create an IPv6 global unicast address. The prefix is 2001:db8:acad:1::/64. By the way, use my link-local address fe80::1 as your default gateway."*

# arrow_back_ios

Q1 Q2 Result Page

# arrow_forward_ios

## 13.1.6 Check Your Understanding - ICMP Messages

**Instructions:**

![](https://www.netacad.com/content/itn/1.0/assets/icons8-info-16.svg)

- The exam consists of **2** questions and **70**% is required to pass.
- You have **unlimited attempts** to pass the exam.
- You have **no** time limit per attempt to pass the exam.

Start

# **Question 1**

Which two types of ICMP messages are common to both ICMPv4 and ICMPv6? (Choose two.)

- [ ]  
    
    **done**Destination or Service Unreachable
    
- [ ]  
    
    Hostname resolution
    
- [ ]  
    
    IP configuration
    
- [ ]  
    
    **close**Source Unreachable
    
- [ ]  
    
    Time exceeded
    

# **Question 2**

Which type of ICMPv6 message would a host send to acquire an IPv6 configuration when booting up?

Neighbor Advertisement (NA) message

Neighbor Solicitation (NS) message

Router Advertisement (RA) message

**done**Router Solicitation (RS) message

# **50%**

You have scored **50%**.

You have not passed the exam.

Select Reset to retake the exam. Remember that you can return to the module for reference or to retake the exam at any time.

# 13.2 Ping and Traceroute Tests

Scroll to begin

# **13.2.1 Ping - Test Connectivity**

In the previous topic, you were introduced to the **ping** and traceroute (**tracert**) tools. In this topic, you will learn about the situations in which each tool is used, and how to use them. Ping is an IPv4 and IPv6 testing utility that uses ICMP echo request and echo reply messages to test connectivity between hosts.

To test connectivity to another host on a network, an echo request is sent to the host address using the **ping** command. If the host at the specified address receives the echo request, it responds with an echo reply. As each echo reply is received, **ping** provides feedback on the time between when the request was sent and when the reply was received. This can be a measure of network performance.

Ping has a timeout value for the reply. If a reply is not received within the timeout, ping provides a message indicating that a response was not received. This may indicate that there is a problem, but could also indicate that security features blocking ping messages have been enabled on the network. It is common for the first ping to timeout if address resolution (ARP or ND) needs to be performed before sending the ICMP Echo Request.

After all the requests are sent, the **ping** utility provides a summary that includes the success rate and average round-trip time to the destination.

Type of connectivity tests performed with **ping** include the following:

- Pinging the local loopback
- Pinging the default gateway
- Pinging the remote host

# **13.2.2 Ping the Loopback**

Ping can be used to test the internal configuration of IPv4 or IPv6 on the local host. To perform this test, **ping** the local loopback address of 127.0.0.1 for IPv4 (::1 for IPv6).

A response from 127.0.0.1 for IPv4, or ::1 for IPv6, indicates that IP is properly installed on the host. This response comes from the network layer. This response is not, however, an indication that the addresses, masks, or gateways are properly configured. Nor does it indicate anything about the status of the lower layer of the network stack. This simply tests IP down through the network layer of IP. An error message indicates that TCP/IP is not operational on the host.

shows the Ethernet properties dialogue box shows that Internet Protocol Version 4 (TCP/IPv4) is installed and active which is proved with a ping to 127.0.0.1

C:\>ping 127.0.0.1

![](https://www.netacad.com/content/itn/1.0/_assets/media/2e54d2a0-1c25-11ea-a010-eb2108469056/2e54d2a3-1c25-11ea-81a0-ffc2c49b96bc.png)

*• Pinging the local host confirms that TCP/IP is installed and working on the local host.
• Pinging 127.0.0.1 causes a device to ping itself.*

- • Pinging the local host confirms that TCP/IP is installed and working on the local host.
- • Pinging 127.0.0.1 causes a device to ping itself.

# **13.2.3 Ping the Default Gateway**

You can also use **ping** to test the ability of a host to communicate on the local network. This is generally done by pinging the IP address of the default gateway of the host. A successful **ping** to the default gateway indicates that the host and the router interface serving as the default gateway are both operational on the local network.

For this test, the default gateway address is most often used because the router is normally always operational. If the default gateway address does not respond, a **ping** can be sent to the IP address of another host on the local network that is known to be operational.

If either the default gateway or another host responds, then the local host can successfully communicate over the local network. If the default gateway does not respond but another host does, this could indicate a problem with the router interface serving as the default gateway.

One possibility is that the wrong default gateway address has been configured on the host. Another possibility is that the router interface may be fully operational but have security applied to it that prevents it from processing or responding to ping requests.

The graphic shows the Ethernet properties dialogue box configured with a static IP address, subnet mask, and default gateway. The topology shows the PC sending an echo request to the router default gateway and the routers echo response reply.

ECHO REQUEST

ECHO REPLY

10.0.0.1255.255.255.0

10.0.0.254255.255.255.0

G0/0/0

![](https://www.netacad.com/content/itn/1.0/_assets/media/2e54f9b0-1c25-11ea-a010-eb2108469056/2e54f9b4-1c25-11ea-81a0-ffc2c49b96bc.jpg)

*The host pings its default gateway, sending an ICMP echo request. The default gateway sends an echo reply confirming connectivity.*

# **13.2.4 Ping a Remote Host**

Ping can also be used to test the ability of a local host to communicate across an internetwork. The local host can ping an operational IPv4 host of a remote network, as shown in the figure. The router uses its IP routing table to forward the packets.

If this ping is successful, the operation of a large piece of the internetwork can be verified. A successful **ping** across the internetwork confirms communication on the local network, the operation of the router serving as the default gateway, and the operation of all other routers that might be in the path between the local network and the network of the remote host.

Additionally, the functionality of the remote host can be verified. If the remote host could not communicate outside of its local network, it would not have responded.

**Note:** Many network administrators limit or prohibit the entry of ICMP messages into the corporate network; therefore, the lack of a **ping** response could be due to security restrictions.

animation shows a ping echo request to a remote network that is routed through a router and the echo reply that is routed back from the remote network

Echo request

Echo reply

IP Routing Table

# play_circle_filled

# **13.2.5 Traceroute - Test the Path**

Ping is used to test connectivity between two hosts but does not provide information about the details of devices between the hosts. Traceroute (**tracert**) is a utility that generates a list of hops that were successfully reached along the path. This list can provide important verification and troubleshooting information. If the data reaches the destination, then the trace lists the interface of every router in the path between the hosts. If the data fails at some hop along the way, the address of the last router that responded to the trace can provide an indication of where the problem or security restrictions are found.

**Round Trip Time (RTT)**

Using traceroute provides round-trip time for each hop along the path and indicates if a hop fails to respond. The round-trip time is the time a packet takes to reach the remote host and for the response from the host to return. An asterisk (*) is used to indicate a lost or unreplied packet.

This information can be used to locate a problematic router in the path or may indicate that the router is configured not to reply. If the display shows high response times or data losses from a particular hop, this is an indication that the resources of the router or its connections may be stressed.

**IPv4 TTL and IPv6 Hop Limit**

Traceroute makes use of a function of the TTL field in IPv4 and the Hop Limit field in IPv6 in the Layer 3 headers, along with the ICMP Time Exceeded message.

Play the animation in the figure to see how traceroute takes advantage of TTL.

animation shows a traceroute to a remote network that crosses three routers. The traceroute will take 4 echo requests to reach its destination

ICMP Echo reply

ICMPTime Exceeded

ICMPTime Exceeded

ICMPTime Exceeded

**Traceroute192.168.1.2(TTL = 4)**

**Traceroute192.168.1.2(TTL = 3)**

**Traceroute192.168.1.2(TTL = 2)**

**Traceroute192.168.1.2(TTL = 1)**

# play_circle_filled

The first sequence of messages sent from traceroute will have a TTL field value of 1. This causes the TTL to time out the IPv4 packet at the first router. This router then responds with an ICMPv4 Time Exceeded message. Traceroute now has the address of the first hop.

Traceroute then progressively increments the TTL field (2, 3, 4...) for each sequence of messages. This provides the trace with the address of each hop as the packets time out further down the path. The TTL field continues to be increased until the destination is reached, or it is incremented to a predefined maximum.

After the final destination is reached, the host responds with either an ICMP Port Unreachable message or an ICMP Echo Reply message instead of the ICMP Time Exceeded message.

# **13.2.6 Packet Tracer - Verify IPv4 and IPv6 Addressing**

IPv4 and IPv6 can coexist on the same network. From the command prompt of a PC, there are some differences in the way commands are issued and in the way output is displayed.

**description**Verify IPv4 and IPv6 Addressing[**file_download**Verify IPv4 and IPv6 Addressing](https://www.netacad.com/content/itn/1.0/courses/content/m13/en-US/assets/13.2.6-packet-tracer---verify-ipv4-and-ipv6-addressing.pka)

# **13.2.7 Packet Tracer - Use Ping and Traceroute to Test Network Connectivity**

There are connectivity issues in this activity. In addition to gathering and documenting information about the network, you will locate the problems and implement acceptable solutions to restore connectivity.

**description**Use Ping and Traceroute to Test Network Connectivity[**file_download**Use Ping and Traceroute to Test Network Connectivity](https://www.netacad.com/content/itn/1.0/courses/content/m13/en-US/assets/13.2.7-packet-tracer---use-ping-and-traceroute-to-test-network-connectivity.pka)

# 13.3 Module Practice and Quiz

Scroll to begin

# **13.3.1 Packet Tracer - Use ICMP to Test and Correct Network Connectivity**

In this lab you will use ICMP to test network connectivity and locate network problems. You will also correct simple configuration issues and restore connectivity to the network.

Use ICMP to locate connectivity issues.

Configure network devices to correct connectivity issues.

**description**Use ICMP to Test and Correct Network Connectivity[**file_download**Use ICMP to Test and Correct Network Connectivity](https://www.netacad.com/content/itn/1.0/courses/content/m13/en-US/assets/13.3.1-packet-tracer---use-icmp-to-test-and-correct-network-connectivity.pka)

# **13.3.2 Lab - Use Ping and Traceroute to Test Network Connectivity**

### Skills Practice Opportunity

You have the opportunity to practice the following skills:

- Part 1: Build and Configure the Network
- Part 2: Use Ping Command for Basic Network Testing
- Part 3: Use Tracert and Traceroute Commands for Basic Network Testing
- Part 4: Troubleshoot the Topology

You can practice these skills using the Packet Tracer or lab equipment, if available.

**Packet Tracer - Physical Mode (PTPM)**

**description**Use Ping and Traceroute to Test Network Connectivity - Physical Mode[**file_download**Use Ping and Traceroute to Test Network Connectivity - Physical Mode](https://www.netacad.com/content/itn/1.0/courses/content/m13/en-US/assets/13.3.2-packet-tracer---use-ping-and-traceroute-to-test-network-connectivity---physical-mode.pka)

**Lab Equipment**

**description**Use Ping and Traceroute to Test Network Connectivity

# **13.3.3 What did I learn in this module?**

**ICMP Messages**

The TCP/IP suite provides for error messages and informational messages when communicating with another IP device. These messages are sent using ICMP. The purpose of these messages is to provide feedback about issues related to the processing of IP packets under certain conditions. The ICMP messages common to both ICMPv4 and ICMPv6 are: Host reachability, Destination or Service Unreachable, and Time exceeded. An ICMP Echo Message tests the reachability of a host on an IP network. The local host sends an ICMP Echo Request to a host. If the host is available, the destination host responds with an Echo Reply. This is the basis of the **ping** utility. When a host or gateway receives a packet that it cannot deliver, it can use an ICMP Destination Unreachable message to notify the source. The message will include a code that indicates why the packet could not be delivered. An ICMPv4 Time Exceeded message is used by a router to indicate that a packet cannot be forwarded because the Time to Live (TTL) field of the packet was decremented to zero. If a router receives a packet and decrements the TTL field to zero, it discards the packet and sends a Time Exceeded message to the source host. ICMPv6 also sends a Time Exceeded in this situation. ICMPv6 uses the IPv6 hop limit field to determine if the packet has expired. Time Exceeded messages are used by the **traceroute** tool. The messages between an IPv6 router and an IPv6 device including dynamic address allocation include RS and RA. The messages between IPv6 devices include the redirect (similar to IPv4), NS and NA.

**Ping and Traceroute Testing**

Ping (used by IPv4 and IPv6) uses ICMP echo request and echo reply messages to test connectivity between hosts. To test connectivity to another host on a network, an echo request is sent to the host address using the ping command. If the host at the specified address receives the echo request, it responds with an echo reply. As each echo reply is received, ping provides feedback on the time between when the request was sent and when the reply was received. After all the requests are sent, the ping utility provides a summary that includes the success rate and average round-trip time to the destination. Ping can be used to test the internal configuration of IPv4 or IPv6 on the local host. Ping the local loopback address of 127.0.0.1 for IPv4 (::1 for IPv6). Use **ping** to test the ability of a host to communicate on the local network, by pinging the IP address of the default gateway of the host. A successful ping to the default gateway indicates that the host and the router interface serving as the default gateway are both operational on the local network. Ping can also be used to test the ability of a local host to communicate across an internetwork. The local host can **ping** an operational IPv4 host of a remote network. Traceroute (tracert) generates a list of hops that were successfully reached along the path. This list provides verification and troubleshooting information. If the data reaches the destination, then the trace lists the interface of every router in the path between the hosts. If the data fails at some hop along the way, the address of the last router that responded to the trace can provide an indication of where the problem or security restrictions are found. The round-trip time is the time a packet takes to reach the remote host and for the response from the host to return. Traceroute makes use of a function of the TTL field in IPv4 and the Hop Limit field in IPv6 in the Layer 3 headers, along with the ICMP time exceeded message.

# arrow_back_ios

Q1 Q2 Q3 Q4 Q5 Q6 Q7 Q8 Q9 Q10 Q11 Q12 Q13 Q14 Result Page

# arrow_forward_ios

## Module Quiz - ICMP

**Instructions:**

![](https://www.netacad.com/content/itn/1.0/assets/icons8-info-16.svg)

- The exam consists of **30** questions and **70**% is required to pass.
- You have **unlimited attempts** to pass the exam.
- You have **no** per attempt to pass the exam.
- You have **no** time limit per attempt to pass the exam.
- Your responses will be automatically submitted once the given time has elapsed.

Start

# **Question 1**

A technician is troubleshooting a network where it is suspected that a defective node in the network path is causing packets to be dropped. The technician only has the IP address of the end point device and does not have any details of the intermediate devices. What command can the technician use to identify the faulty node?

**donetracert**

**ping**

**ipconfig /flushdns**

**ipconfig /displaydns**

# **Question 2**

A user who is unable to connect to the file server contacts the help desk. The helpdesk technician asks the user to ping the IP address of the default gateway that is configured on the workstation. What is the purpose for this **ping** command?

To obtain a dynamic IP address from the server

To request that gateway forward the connection request to the file server

**done**To test that the host has the capability to reach hosts on other networks

To resolve the domain name of the file server to its IP address

# **Question 3**

What is a function of the **tracert** command that differs from the **ping** command when they are used on a workstation?

The **tracert** command reaches the destination faster.

The **tracert** command shows the information of routers in the path.

**close**The **tracert** command sends one ICMP message to each hop in the path.

The **tracert** command is used to test the connectivity between two devices.

# **Question 4**

Which ICMP message is used by the traceroute utility during the process of finding the path between two end hosts?

**close**Redirect

Ping

Time exceeded

Destination unreachable

# **Question 5**

Which utility uses the Internet Control Messaging Protocol (ICMP)?

RIP

DNS

**done**Ping

NTP

# **Question 6**

Which protocol is used by IPv4 and IPv6 to provide error messaging?

**done**ICMP

NDP

ARP

DHCP

# **Question 7**

A network administrator is testing network connectivity by issuing the **ping** command on a router. Which symbol will be displayed to indicate that a time expired during the wait for an ICMP echo reply message?

!

**done**.

U

$

# **Question 8**

Which two things can be determined by using the **ping** command? (Choose two.)

- [ ]  
    
    The number of routers between the source and destination device
    
- [ ]  
    
    The IP address of the router nearest the destination device
    
- [ ]  
    
    **done**The average time it takes a packet to reach the destination and for the response to return to the source
    
- [ ]  
    
    **done**The destination device is reachable through the network
    
- [ ]  
    
    The average time it takes each router in the path between source and destination to respond
    

# **Question 9**

A user calls to report that a PC cannot access the internet. The network technician asks the user to issue the command **ping 127.0.0.1** in a command prompt window. The user reports that the result is four positive replies. What conclusion can be drawn based on this connectivity test?

**close**The PC can access the network. The problem exists beyond the local network.

The IP address obtained from the DHCP server is correct.

The PC can access the Internet. However, the web browser may not work.

The TCP/IP implementation is functional.

# **Question 10**

Which command can be used to test connectivity between two devices using echo request and echo reply messages?

**netstat**

**ipconfig**

**ICMP**

**doneping**

# **Question 11**

What field content is used by ICMPv6 to determine that a packet has expired?

TTL field

CRC field

Hop Limit field

**close**Time Exceeded field

# **Question 12**

Which protocol provides feedback from the destination host to the source host about errors in packet delivery?

ARP

BOOTP

DNS

**done**ICMP

# **Question 13**

A network administrator can successfully ping the server at [www.cisco.com](http://www.cisco.com/), but cannot ping the company web server located at an ISP in another city. Which tool or command would help identify the specific router where the packet was lost or delayed?

**ipconfig**

**netstat**

**telnet**

**donetraceroute**

# **Question 14**

What message is sent by a host to check the uniqueness of an IPv6 address before using that address?

Neighbor solicitation

ARP request

Echo request

**close**Router solicitation

# **64%**

You have scored **64%**.

You have not passed the exam.

Select Reset to retake the exam. Remember that you can return to the module for reference or to retake the exam at any time.

Reset

Review Assessment