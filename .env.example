# notion-learning-sync configuration
# Copy this file to .env and fill in your values
# See docs/notion/NOTION_SCHEMA_SPEC.md for database setup instructions

# ========================================
# Database (Required)
# ========================================
DATABASE_URL=postgresql://postgres:learning123@localhost:5432/notion_learning_sync

# ========================================
# Notion API (Required)
# ========================================
NOTION_API_KEY=secret_xxxxx
NOTION_VERSION=2022-06-28

# ─── Cortex 2.0 Core Databases ─────────────────────────────────────────────
# All-Atom Master Database (Primary)
FLASHCARDS_DB_ID=

# Knowledge Hierarchy
SUPERCONCEPTS_DB_ID=        # L0 Areas + L1 Clusters
SUBCONCEPTS_DB_ID=          # Being merged into Flashcards

# Projects (for Z-Score project relevance signal)
PROJECTS_DB_ID=

# ─── Legacy Databases (backwards compatibility) ────────────────────────────
CONCEPTS_DB_ID=
CONCEPT_AREAS_DB_ID=
CONCEPT_CLUSTERS_DB_ID=

# ─── Curriculum Structure Databases (3) ─────────────────────────────────────
MODULES_DB_ID=
TRACKS_DB_ID=
PROGRAMS_DB_ID=

# ─── Activity & Session Databases (2) ───────────────────────────────────────
ACTIVITIES_DB_ID=
SESSIONS_DB_ID=

# ─── Assessment & Practice Databases (2) ────────────────────────────────────
QUIZZES_DB_ID=
CRITICAL_SKILLS_DB_ID=

# ─── Knowledge Support Databases (3) ────────────────────────────────────────
RESOURCES_DB_ID=
MENTAL_MODELS_DB_ID=
EVIDENCE_DB_ID=

# ─── Neuroplasticity Databases (4) ──────────────────────────────────────────
BRAIN_REGIONS_DB_ID=
TRAINING_PROTOCOLS_DB_ID=
PRACTICE_LOGS_DB_ID=
ASSESSMENTS_DB_ID=

# ========================================
# Anki Integration
# ========================================
ANKI_CONNECT_URL=http://127.0.0.1:8765
ANKI_DECK_NAME=LearningOS::Synced
ANKI_NOTE_TYPE=Basic

# ========================================
# AI Integration (Optional - for cleaning/rewriting)
# ========================================
# Google Generative AI (Gemini)
GEMINI_API_KEY=

# Google Cloud Vertex AI (alternative to Gemini)
VERTEX_PROJECT=
VERTEX_LOCATION=us-central1

# Model to use for AI operations
AI_MODEL=gemini-2.0-flash

# ========================================
# Cortex 2.0: Neo4j Shadow Graph
# ========================================
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=cortex2025
NEO4J_DATABASE=cortex

# ========================================
# Cortex 2.0: Z-Score Algorithm
# ========================================
# Weights (must sum to 1.0)
ZSCORE_WEIGHT_DECAY=0.30        # Time since last touch
ZSCORE_WEIGHT_CENTRALITY=0.25   # Graph importance (PageRank)
ZSCORE_WEIGHT_PROJECT=0.25      # Active project relevance
ZSCORE_WEIGHT_NOVELTY=0.20      # New/fresh atoms

# Thresholds
ZSCORE_ACTIVATION_THRESHOLD=0.5  # Minimum for Focus Stream
ZSCORE_DECAY_HALFLIFE_DAYS=7     # Half-life for time decay

# ========================================
# Cortex 2.0: Force Z Backtracking
# ========================================
FORCE_Z_MASTERY_THRESHOLD=0.65   # Prerequisite mastery threshold
FORCE_Z_MAX_DEPTH=5              # Max backtracking depth

# ========================================
# Cortex 2.0: PLM Sidecar
# ========================================
PLM_PROTOCOL=cortex://
PLM_TARGET_RESPONSE_MS=800       # Target fluency response time
PLM_ACCURACY_THRESHOLD=0.90      # Fluency accuracy threshold

# ========================================
# Cortex 2.0: Sync Strategy
# ========================================
SYNC_REFLEX_ENABLED=true         # Webhook-based immediate sync
SYNC_PULSE_INTERVAL_MINUTES=5    # Polling sync interval
SYNC_AUDIT_HOUR=2                # Nightly deep audit hour (0-23)

# ========================================
# Cortex 2.0: Notion Property Names
# ========================================
# Override these if your Notion database uses different property names

# Core Properties
NOTION_PROP_QUESTION=Question
NOTION_PROP_ANSWER=Answer
NOTION_PROP_ATOM_TYPE=Atom_Type
NOTION_PROP_HIERARCHY_LEVEL=Hierarchy_Level

# Z-Score Properties
NOTION_PROP_Z_SCORE=Z_Score
NOTION_PROP_Z_ACTIVATION=Z_Activation

# Memory Properties
NOTION_PROP_MEMORY_STATE=Memory_State
NOTION_PROP_STABILITY=Stability
NOTION_PROP_DIFFICULTY=Difficulty
NOTION_PROP_LAST_REVIEW=Last_Review
NOTION_PROP_NEXT_REVIEW=Next_Review
NOTION_PROP_REVIEW_COUNT=Review_Count
NOTION_PROP_LAPSES=Lapses

# Cognitive Properties
NOTION_PROP_PSI=PSI
NOTION_PROP_PFIT=PFIT

# Quality Properties
NOTION_PROP_QUALITY_GRADE=Quality_Grade
NOTION_PROP_VALIDATION=Validation_Status

# Relation Properties
NOTION_PROP_PREREQUISITES=Prerequisites
NOTION_PROP_CONFUSABLES=Confusables
NOTION_PROP_PARENT_CONCEPT=Parent_Concept
NOTION_PROP_MODULE=Module

# PLM
NOTION_PROP_LAUNCH_PLM=Launch_PLM

# ========================================
# Atomicity Thresholds (Evidence-Based)
# ========================================
ATOMICITY_FRONT_MAX_WORDS=25
ATOMICITY_BACK_OPTIMAL_WORDS=5
ATOMICITY_BACK_WARNING_WORDS=15
ATOMICITY_BACK_MAX_CHARS=120
ATOMICITY_MODE=relaxed  # relaxed or strict

# ========================================
# Sync Behavior
# ========================================
SYNC_INTERVAL_MINUTES=120  # 0 to disable auto-sync
PROTECT_NOTION=true        # Prevent writes to Notion (IMPORTANT: set to false to enable writes)
DRY_RUN=false              # Log actions without changes

# ========================================
# Logging
# ========================================
LOG_LEVEL=INFO
LOG_FILE=logs/notion_learning_sync.log

# ========================================
# API Server
# ========================================
API_HOST=127.0.0.1
API_PORT=8100

# ========================================
# FSRS Settings (Spaced Repetition)
# ========================================
FSRS_DEFAULT_STABILITY=1.0    # Initial stability for new cards (days)
FSRS_DEFAULT_DIFFICULTY=0.3   # Initial difficulty (0-1)
FSRS_DESIRED_RETENTION=0.9    # Target retention rate
